<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Shipgrav &#8212; shipgrav 0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=837179f8"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-shipgrav">
<span id="shipgrav"></span><h1>Shipgrav<a class="headerlink" href="#module-shipgrav" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>shipgrav is a Python package with utilities for reading and processing marine gravity data from UNOLS ships. At time of writing, the UNOLS fleet is transitioning away from BGM3 gravimeters to DGS AT1M meters managed by the Potential Field Pool Equipment (PFPE) facility. shipgrav is able to read files from both types of meters, as well as navigation data and other vessel feeds.</p>
<p>DGS gravimeters output two types of files: serial, or ‘raw’ files; and ‘laptop’ files. Raw files are written from the serial port, and contain counts values that can be calibrated to retrieve the gravity signal. In this documentation we use the terms ‘serial’ and ‘raw’ interchangeably.  What we refer to as laptop files are lightly processed onboard the meter and output with (biased) gravity values alongside other information.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<p>shipgrav’s dependencies are</p>
<ul class="simple">
<li><p>Python 3.9+</p></li>
<li><p>numpy</p></li>
<li><p>scipy</p></li>
<li><p>pandas 2.0+</p></li>
<li><p>statsmodels</p></li>
<li><p>tomli</p></li>
<li><p>pyyaml</p></li>
</ul>
<p>matplotlib is also required to run some of the example scripts.</p>
<p>To install and use shipgrav, using an environment managing tool is recommended. An exemplary way to do this using <a class="reference external" href="https://anaconda.org">conda</a> would be to use these commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">--</span><span class="n">name</span> <span class="n">shipgrav</span> <span class="n">numpy</span> <span class="n">scipy</span> <span class="n">pandas</span> <span class="n">statsmodels</span> <span class="n">tomli</span> <span class="n">pyyaml</span> <span class="n">matplotlib</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">shipgrav</span>
<span class="n">cd</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">put</span><span class="o">/</span><span class="n">source</span><span class="o">/</span><span class="n">files</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">hfmark</span><span class="o">/</span><span class="n">shipgrav</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">shipgrav</span><span class="o">/</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">.</span>
</pre></div>
</div>
</section>
<section id="modules-and-files">
<h2>Modules and files<a class="headerlink" href="#modules-and-files" title="Link to this heading">¶</a></h2>
<p>shipgrav consists of the modules <code class="docutils literal notranslate"><span class="pre">io</span></code>, <code class="docutils literal notranslate"><span class="pre">nav</span></code>, <code class="docutils literal notranslate"><span class="pre">grav</span></code>, and <code class="docutils literal notranslate"><span class="pre">utils</span></code>, along with the file <code class="docutils literal notranslate"><span class="pre">database.toml</span></code> and a set of example scripts and data files.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">io</span></code> contains functions for reading different kinds of gravimeter files and associated navigation files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nav</span></code> contains functions for handling coordinate systems.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grav</span></code> contains functions for processing gravity data and calculating various anomalies.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">utils</span></code> is a catch-all of other things we need.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">database.toml</span></code> holds some ship-specific constants and other information for UNOLS vessels.</p></li>
<li><p>the scripts in <code class="docutils literal notranslate"><span class="pre">example-scripts</span></code> walk through the steps of reading and processing UNOLS gravimeter data for a set of sample data files.</p></li>
</ul>
</section>
<section id="data-directories">
<h2>Data directories<a class="headerlink" href="#data-directories" title="Link to this heading">¶</a></h2>
<p>You can organize your data however you like; shipgrav does not care as long as you tell it where to look. However, the example scripts are all set up using a particular organization system that you may like to emulate. You can see this structure in the data files that accompany the example scripts.</p>
</section>
<section id="navigation-data">
<h2>Navigation data<a class="headerlink" href="#navigation-data" title="Link to this heading">¶</a></h2>
<p>Which navigation data should you use to process gravimeter data?</p>
<p>In an ideal world, the DGS meter pulls navigation info from the ship’s feed and synchronizes it perfectly with acquisition such that the output files have the correct geographic coordinates in them at the start. In practice, this synchronization doesn’t always work as expected (see <code class="docutils literal notranslate"><span class="pre">example-scripts/dgs_raw_comp.py</span></code> for a case where the serial files do not have GPS info). So, we like to take the timestamped navigation data directly from the ship’s feed and match up the DGS timestamps to obtain more accurate coordinates.</p>
<p>The database file included in shipgrav lists the navigation talkers that we expect are good to use for specific UNOLS vessels. Find the files that contain those feeds, and you should be able to read in timestamped coordinates from them.</p>
</section>
<section id="example-scripts">
<h2>Example scripts<a class="headerlink" href="#example-scripts" title="Link to this heading">¶</a></h2>
<p>The scripts in the <code class="docutils literal notranslate"><span class="pre">example-scripts</span></code> directory use sample data files to run through some common workflows. The sample data files are not available on github because of file size limits but we’re working on making them available for download elsewhere.</p>
<p><code class="docutils literal notranslate"><span class="pre">dgs_bgm_comp.py</span></code> reads data from DGS and BGM gravimeter files from R/V Thompson cruise TN400. The files are lightly processed to obtain the FAA (including syncing with navigation data for more accurate locations), and the FAA is plotted alongside corresponding satellite-derived FAA.</p>
<p><code class="docutils literal notranslate"><span class="pre">dgs_raw_comp.py</span></code> reads laptop and serial data from R/V Sally Ride cruise SR2312. The serial data are calibrated and compared to the laptop data. The laptop data are processed to FAA and plotted alongside satellite-derived FAA.</p>
<p><code class="docutils literal notranslate"><span class="pre">dgs_ccp_calc.py</span></code> reads an example set of laptop files provided by DGS, calculates the FAA and various kinematic variables, and fits for cross-coupling coefficients. The coefficients derived from the data are compared to values that were provided by DGS. The cross-coupling correction is applied and the data are plotted with and without correction.</p>
<p><code class="docutils literal notranslate"><span class="pre">mru_coherence.py</span></code> reads laptop data and other feeds from R/V Sally Ride cruise SR2312. The FAA is calculated, and MRU info is read to obtain time series of pitch, roll, and heave. Coherence is caluclated between those and each of the four monitors output by the gravimeter for the cross-coupling correction.</p>
<p><code class="docutils literal notranslate"><span class="pre">interactive_line_pick.py</span></code> reads laptop data and navigation data from R/V Sally Ride cruise SR2312. The script generates an interactive plot with a cursor for users to select segments of the time series data based on mapped locations, in order to extract straight line segments from a cruise track. The selected segments are written to files that can be re-read by the next script…</p>
<p><code class="docutils literal notranslate"><span class="pre">RMBA_calc.py</span></code> reads an example of data from a line segment (from the interactive line picker) and calcualtes the residual mantle bouger anomaly (RMBA) as well as estimated crustal thickness variations.</p>
</section>
<section id="help">
<h2>Help!<a class="headerlink" href="#help" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">FileNotFound</span></code> <strong>errors:</strong> check the filepaths in your scripts and make sure that (a) there are no typos, and (b) you are pointing toward the actual locations of your data files.</p>
<p><strong>Other file reading errors:</strong> shipgrav does its best to read a variety of file formats from UNOLS gravimeters, but we can’t read files that we don’t know enough about ahead of time. In some cases, a file cannot be read because we don’t yet know how to pass the file to the correct parsing function. Most primary i/o functions in shipgrav have an option where users can supply their own file-parsing function, so one option is to write such a function (following the examples in shipgrav for known vessel file formats) and plug that in via the appropriate kwarg (usually named <code class="docutils literal notranslate"><span class="pre">ship_function</span></code>). You can also send an example file and information to PFPE so that we can update shipgrav.</p>
<p><strong>The anomaly I’ve calculated looks really weird:</strong> a good first step is to compare your (lowpass filtered) FAA to satellite data (e.g., Sandwell et al. 2014, doi: 10.1126/science.1258213). If that looks very different, you can start checking whether the data is being read properly; whether the sample rate of the data is consistent with your expectations; whether there are anomalous spikes or dropouts in the data that need to be cleaned out; and whether the corrections used to calculate the FAA seem to have reasonable magnitudes.</p>
<p><strong>If you have some other question that’s not answered here:</strong> you can try contacting PFPE for specific assistance with processing UNOLS gravimeter data.</p>
</section>
<section id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Link to this heading">¶</a></h2>
<p>shipgrav comes with a set of unit tests. To run them for yourself, navigate to the <code class="docutils literal notranslate"><span class="pre">tests/</span></code> directory and run <code class="docutils literal notranslate"><span class="pre">__main__.py</span></code> (in an environment with dependencies installed, naturally).</p>
</section>
<section id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Link to this heading">¶</a></h2>
<p>Do you have ideas for making this software better? Go ahead and <a class="reference external" href="https://github.com/hfmark/shipgrav/issues">raise an issue</a> on the github page or, if you’re a savvy Python programmer, submit a pull request. You can also email PFPE.</p>
</section>
</section>
<section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading">¶</a></h1>
<section id="module-shipgrav.io">
<span id="io-module"></span><h2><code class="xref py py-mod docutils literal notranslate"><span class="pre">io</span></code> Module<a class="headerlink" href="#module-shipgrav.io" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.io.read_bgm_raw">
<span class="sig-prename descclassname"><span class="pre">shipgrav.io.</span></span><span class="sig-name descname"><span class="pre">read_bgm_raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ship</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ship_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.io.read_bgm_raw" title="Link to this definition">¶</a></dt>
<dd><p>Read BGM gravity from raw (serial) files (not RGS).</p>
<p>This function uses scale factors determined for specific BGM meters
to convert counts from the raw files to raw gravity. Known scale
factors are listed in database.toml.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> – BGM raw filepath(s), string or list of strings</p></li>
<li><p><strong>ship</strong> – ship name, string</p></li>
<li><p><strong>scale</strong> – optional, give BGM counts scaling factor outside of database.toml</p></li>
<li><p><strong>ship_function</strong> – user-supplied function for reading/parsing BGM raw files.
The function should return a pandas.DataFrame with timestamps and counts.
Look at _bgmserial_Atlantis() and similar functions for examples.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.io.read_bgm_rgs">
<span class="sig-prename descclassname"><span class="pre">shipgrav.io.</span></span><span class="sig-name descname"><span class="pre">read_bgm_rgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ship</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.io.read_bgm_rgs" title="Link to this definition">¶</a></dt>
<dd><p>Read BGM gravity from RGS files.</p>
<p>RGS seems to be a standard format, but so far I’ve only seen
examples from Atlantis and NBP so there may variations elsewhere.</p>
<p>This function returns a pandas.DataFrame with timestamps, raw gravity,
and geographic coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> – RGS filepaths, string or list of strings</p></li>
<li><p><strong>ship</strong> – ship name, string</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.io.read_dat_dgs">
<span class="sig-prename descclassname"><span class="pre">shipgrav.io.</span></span><span class="sig-name descname"><span class="pre">read_dat_dgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ship</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ship_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.io.read_dat_dgs" title="Link to this definition">¶</a></dt>
<dd><p>Read DGS ‘laptop’ file(s), usually written as .dat files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> – filepath(s), string or list of strings</p></li>
<li><p><strong>ship</strong> – ship name, string</p></li>
<li><p><strong>ship_function</strong> – optional, user-defined function for reading a file.
The function should return a pandas.DataFrame. See _dgs_laptop_general()
for an example.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.io.read_nav">
<span class="sig-prename descclassname"><span class="pre">shipgrav.io.</span></span><span class="sig-name descname"><span class="pre">read_nav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ship</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pathlist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">talker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ship_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.io.read_nav" title="Link to this definition">¶</a></dt>
<dd><p>Read navigation strings from .GPS (or similar) files.</p>
<p>Ships have different formats and use different talkers for preferred
navigation; the ones we know are listed in database.toml, and there is
also an option to override that by setting the talker kwarg.
Navigation data is re-interpolated to the given sampling rate.</p>
<p>This function returns a pandas.DataFrame with time series of 
geographic coordinates and corresponding timestamps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ship</strong> – name of the ship, string</p></li>
<li><p><strong>pathlist</strong> – list of paths to navigation files (.GPS), strings</p></li>
<li><p><strong>sampling</strong> – sampling rate to interpolate to, default 1 Hz</p></li>
<li><p><strong>talker</strong> – optional override for talker, string. Default behavior is
to use talker from database.toml if ship is listed there.</p></li>
<li><p><strong>ship_function</strong> – optional user-supplied function for reading from nav files.
This function should return arrays of lon, lat, and timestamps.
Look at _navcoords() and navdate_Atlantis() (and similar functions) for examples.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.io.read_other_stuff">
<span class="sig-prename descclassname"><span class="pre">shipgrav.io.</span></span><span class="sig-name descname"><span class="pre">read_other_stuff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yaml_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.io.read_other_stuff" title="Link to this definition">¶</a></dt>
<dd><p>Read a particular feed (eg, $PASHR) from a data file + yaml file.</p>
<p>This function parses strings for the desired feed and returns info as a 
pandas.DataFrame with columns named from the corresponding yaml file.
If there is a column in the feed strings prior to the tag itself, that 
will be included as a ‘mystery’ dataframe column.</p>
<p>A use case is if you want to check coherence between gravity data and
one or more MRUs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>yaml_file</strong> – path to YAML file with info for this feed</p></li>
<li><p><strong>data_file</strong> – path to data file to be read</p></li>
<li><p><strong>tag</strong> – the name of the feed, with or without the $ prepended</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.io.read_raw_dgs">
<span class="sig-prename descclassname"><span class="pre">shipgrav.io.</span></span><span class="sig-name descname"><span class="pre">read_raw_dgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ship</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_ccp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.io.read_raw_dgs" title="Link to this definition">¶</a></dt>
<dd><p>Read raw (serial) output files from DGS AT1M.</p>
<p>These will be in AD units mostly.
File formatting is assumed to follow what the DGS documentation
says, though some things may vary by vessel so if this doesn’t
work that’s probably why.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> – filepath(s), string or list of strings</p></li>
<li><p><strong>ship</strong> – ship name, string</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-shipgrav.grav">
<span id="grav-module"></span><h2><code class="xref py py-mod docutils literal notranslate"><span class="pre">grav</span></code> Module<a class="headerlink" href="#module-shipgrav.grav" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.grav.calc_ccp">
<span class="sig-prename descclassname"><span class="pre">shipgrav.grav.</span></span><span class="sig-name descname"><span class="pre">calc_ccp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">faa_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcc_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ve_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">al_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samplerate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.grav.calc_ccp" title="Link to this definition">¶</a></dt>
<dd><p>Daniel Aliod’s version of calculating cross-coupling coefficients from some data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>faa_in</strong> – free air anomaly, filtered</p></li>
<li><p><strong>vcc_in</strong> – vcc monitor</p></li>
<li><p><strong>ve_in</strong> – ve monitor</p></li>
<li><p><strong>al_in</strong> – al monitor</p></li>
<li><p><strong>ax_in</strong> – ax monitor</p></li>
<li><p><strong>level_in</strong> – tilt/leveling correction, which is still slightly mysterious. 
Use a vector of zeros to ignore this component.</p></li>
<li><p><strong>times</strong> – optional, vector of timestamps to use for dividing the data
into continuous sections</p></li>
<li><p><strong>samplerate</strong> – optional, used with times to determine where there
are large sampling gaps in the data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.grav.center_diff">
<span class="sig-prename descclassname"><span class="pre">shipgrav.grav.</span></span><span class="sig-name descname"><span class="pre">center_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.grav.center_diff" title="Link to this definition">¶</a></dt>
<dd><p>numerical derivatives, central difference of nth order</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> – data vector</p></li>
<li><p><strong>n</strong> – order, should be 1 or 2</p></li>
<li><p><strong>samp</strong> – sampling rate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.grav.crustal_thickness_2D">
<span class="sig-prename descclassname"><span class="pre">shipgrav.grav.</span></span><span class="sig-name descname"><span class="pre">crustal_thickness_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zdown</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wlarge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wsmall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.grav.crustal_thickness_2D" title="Link to this definition">¶</a></dt>
<dd><p>Downward continuation of gravity to “topographic relief” ie crustal thickness</p>
<p>This can be used in 2D, theoretically, but also works for a single line
given ny=1 (which is the default)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ur</strong> – residual gravity anomaly, mgal</p></li>
<li><p><strong>nx</strong> – number of points in x direction, default 1000</p></li>
<li><p><strong>ny</strong> – number of points in y direction, default 1 (2D)</p></li>
<li><p><strong>dx</strong> – spacing between x points, km, default 1.3</p></li>
<li><p><strong>dy</strong> – spacing between x points, km, default 0 (2D)</p></li>
<li><p><strong>zdown</strong> – downward continuation depth, km, default 10</p></li>
<li><p><strong>rho</strong> – density difference crust to mantle, g/cm^3, default 0.4</p></li>
<li><p><strong>wlarge</strong> – max wavelength for taper/cutoff, km, default 45</p></li>
<li><p><strong>wsmall</strong> – min wavelength for taper/cutoff, km, default 25</p></li>
<li><p><strong>back</strong> – switch for doing reverse tranform if True, default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>crustal thickness variation in km, (recovered gravity
if back=True)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.grav.eotvos_full">
<span class="sig-prename descclassname"><span class="pre">shipgrav.grav.</span></span><span class="sig-name descname"><span class="pre">eotvos_full</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6378137.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6356752.3142</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.grav.eotvos_full" title="Link to this definition">¶</a></dt>
<dd><p>Full Eotvos correction in mGals</p>
<p>From Harlan 1968, “Eotvos Corrections for Airborne Gravimetry” JGR 73(14)</p>
<p>Modified from matlab script written by Sandra Preaux, NGS, NOAA August 24 2009</p>
<p>components:</p>
<ul class="simple">
<li><p>rdoubledot</p></li>
<li><p>angular acceleration of the reference frame</p></li>
<li><p>corliolis</p></li>
<li><p>centrifugal</p></li>
<li><p>centrifugal acceleration of Earth</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitudes in degrees, vector</p></li>
<li><p><strong>lat</strong> – latitudes in degrees, vector</p></li>
<li><p><strong>ht</strong> – elevation (wrt sea level?), vector</p></li>
<li><p><strong>samp</strong> – samplint rate</p></li>
<li><p><strong>a</strong> – optional, major axis of ellipsoid (default is WGS84)</p></li>
<li><p><strong>b</strong> – optional, minor axis of ellipsoid (default is WGS84)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.grav.fa_2ord">
<span class="sig-prename descclassname"><span class="pre">shipgrav.grav.</span></span><span class="sig-name descname"><span class="pre">fa_2ord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ht</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.grav.fa_2ord" title="Link to this definition">¶</a></dt>
<dd><p>2nd order free-air correction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lat</strong> – latitude, degrees</p>
</dd>
<dt class="field-even">Parma height<span class="colon">:</span></dt>
<dd class="field-even"><p>elevation, meters</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.grav.grav2d_long">
<span class="sig-prename descclassname"><span class="pre">shipgrav.grav.</span></span><span class="sig-name descname"><span class="pre">grav2d_long</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xtopo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.grav.grav2d_long" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the gravity anomaly due to a 2D topographic surface with a density contrast.</p>
<p>This function uses the method from Parker and Blakely:</p>
<blockquote>
<div><p>R. L. Parker (1972). The Rapid Calculation of Potential Anomalies,
Geophys J R astr Soc 31, 447-455, DOI: 10.1111/j.1365-246X.1973.tb06513.x</p>
<p>R. J. Blakely (1995). “Ch. 11: Fourier-Domain Modeling” in <strong>Potential Theory in Gravity 
and Magnetic Applications</strong>, Cambridge University Press, DOI: 10.1017/CBO9780511549816</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xtopo</strong> – x coordinates of the surface in meters (must be equally spaced)</p></li>
<li><p><strong>topo</strong> – z coordinates of the surface in meters.</p></li>
<li><p><strong>zlev</strong> – vertical distance for upwards continuation in meters.</p></li>
<li><p><strong>rho</strong> – density contrast across the topography in kg/m^3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>gravity anomaly in mgal.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.grav.longman_tide_pred">
<span class="sig-prename descclassname"><span class="pre">shipgrav.grav.</span></span><span class="sig-name descname"><span class="pre">longman_tide_pred</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.grav.longman_tide_pred" title="Link to this definition">¶</a></dt>
<dd><p>Calculate predicted tidal effect on gravity using the Longman algorithm.</p>
<p>The calculation is taken directly from</p>
<blockquote>
<div><p>Longman (1959). Formulas for Computing the Tidal Accelerations Due to
the Moon and the Sun. Journal of Geophysical Research 64(12), 
DOI: 10.1029/JZ064i012p02351</p>
</div></blockquote>
<p>as are all of the constant and variable descriptions.
Tidal contribution(s) returned are in mGal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude in decimal degrees, positive E, np.ndarray or list</p></li>
<li><p><strong>lat</strong> – latitude in decimal degrees, positive N, np.ndarray or list</p></li>
<li><p><strong>times</strong> – times for geographic locations, datetime.datetime in np.ndarray or list</p></li>
<li><p><strong>alt</strong> – altitude in meters (0 for sea level, for marine grav)</p></li>
<li><p><strong>return_components</strong> – bool; if True, return lunar/solar/total. If False, 
return only the total tidal effect.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.grav.therm_Z">
<span class="sig-prename descclassname"><span class="pre">shipgrav.grav.</span></span><span class="sig-name descname"><span class="pre">therm_Z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1350</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.grav.therm_Z" title="Link to this definition">¶</a></dt>
<dd><p>Calculate depth to an isotherm for a half-space cooling model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – vector of across-axis distance [m] OR plate age [Myr]</p></li>
<li><p><strong>T</strong> – isotherm of choice [K]</p></li>
<li><p><strong>u</strong> – spreading rate [m/yr], default 0.01</p></li>
<li><p><strong>time</strong> – bool switch for x vs age input - if time=True,
u is ignored, default False</p></li>
<li><p><strong>Tm</strong> – <strong>optional</strong> mantle potential temperature [K], default 1350</p></li>
<li><p><strong>rhom</strong> – <strong>optional</strong> mantle density, kg/m^3, default 3300</p></li>
<li><p><strong>rhow</strong> – <strong>optional</strong> water density, kg/m^3, default 1000</p></li>
<li><p><strong>a</strong> – <strong>optional</strong> coefficient of thermal expansion, m^2/sec, default 3e-5</p></li>
<li><p><strong>k</strong> – <strong>optional</strong> thermal diffusivity, m^2/sec, default 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>depth of isotherm below seafloor [m], seafloor subsidence [m]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.grav.therm_Z_plate_approx">
<span class="sig-prename descclassname"><span class="pre">shipgrav.grav.</span></span><span class="sig-name descname"><span class="pre">therm_Z_plate_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zL0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1350</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zsp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.grav.therm_Z_plate_approx" title="Link to this definition">¶</a></dt>
<dd><p>Calculate approximate depth to an isotherm in the plate cooling model</p>
<p>This is done by calculating a temperature field with a decent z spacing 
and finding the closest points to the isotherm, so it depends strongly 
on the z spacing that you use. If you need depth to multiple isotherms
it’s most efficient to get them all at once (using a longer array for
T) so the whole temperature field is only calculated one time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – array of across-axis distance (meters) OR plate age (Myr)</p></li>
<li><p><strong>T</strong> – array of temperatures for which you want isotherms (K)</p></li>
<li><p><strong>u</strong> – spreading rate (m/yr), default 0.01</p></li>
<li><p><strong>zL0</strong> – plate thickness (meters), default 100e3</p></li>
<li><p><strong>Tm</strong> – mantle potential temperature (K), default 1350</p></li>
<li><p><strong>time</strong> – bool switch for x vs age input. If time=True, u is ignored.</p></li>
<li><p><strong>minz</strong> – minimum z for calculating T field (meters), default 0</p></li>
<li><p><strong>maxz</strong> – maximum z (meters), default 100e3</p></li>
<li><p><strong>zps</strong> – z spacing for grid (meters), default 1e3</p></li>
<li><p><strong>rhom</strong> – <strong>optional</strong> mantle density, kg/m^3, default 3300</p></li>
<li><p><strong>rhow</strong> – <strong>optional</strong> water density, kg/m^3, default 1000</p></li>
<li><p><strong>a</strong> – <strong>optional</strong> coefficient of thermal expansion, m^2/sec, default 3e-5</p></li>
<li><p><strong>k</strong> – <strong>optional</strong> thermal diffusivity, m^2/sec, default 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>depths to isotherms as a function of z: depth[T,x]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.grav.therm_halfspace">
<span class="sig-prename descclassname"><span class="pre">shipgrav.grav.</span></span><span class="sig-name descname"><span class="pre">therm_halfspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1350</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.grav.therm_halfspace" title="Link to this definition">¶</a></dt>
<dd><p>Calculate thermal structure for a half space model.</p>
<p>Reference:</p>
<blockquote>
<div><p>D. Turcotte &amp; G. Schubert (2014). Geodynamics. Cambridge
University Press. DOI: 10.1017/CBO9780511843877
Relevant pages: 161-162, 174-176 in 2nd or 3rd ed?</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – vector of across-axis distance (meters) OR of plate ages (Myr)</p></li>
<li><p><strong>z</strong> – vector of depth (meters)</p></li>
<li><p><strong>u</strong> – spreading rate (m/yr)</p></li>
<li><p><strong>time</strong> – bool switch for x vs age input: if ages, set time=True
and u will be ignored.</p></li>
<li><p><strong>rhom</strong> – <strong>optional</strong> mantle density, kg/m^3, default 3300</p></li>
<li><p><strong>rhow</strong> – <strong>optional</strong> water density, kg/m^3, default 1000</p></li>
<li><p><strong>a</strong> – <strong>optional</strong> coefficient of thermal expansion, m^2/sec, default 3e-5</p></li>
<li><p><strong>k</strong> – <strong>optional</strong> thermal diffusivity, m^2/sec, default 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>gridded temperature over (x,z), seafloor subsidence (meters)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.grav.therm_plate">
<span class="sig-prename descclassname"><span class="pre">shipgrav.grav.</span></span><span class="sig-name descname"><span class="pre">therm_plate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zL0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1350</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.grav.therm_plate" title="Link to this definition">¶</a></dt>
<dd><p>Calculate thermal structure for the plate cooling model.</p>
<p>Reference:</p>
<blockquote>
<div><p>D. Turcotte &amp; G. Schubert (2014). Geodynamics. Cambridge
University Press. DOI: 10.1017/CBO9780511843877</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – vector of across-axis distance (meters) OR plate age (Myr)</p></li>
<li><p><strong>z</strong> – vector of depth (meters)</p></li>
<li><p><strong>u</strong> – spreading rate (m/yr), default 0.01</p></li>
<li><p><strong>zL0</strong> – plate thickness (meters), default 100e3</p></li>
<li><p><strong>time</strong> – bool switch for x vs age input. If time=True, u is ignored.</p></li>
<li><p><strong>Tm</strong> – mantle potential temperature (K), default 1350</p></li>
<li><p><strong>rhom</strong> – <strong>optional</strong> mantle density, kg/m^3, default 3300</p></li>
<li><p><strong>rhow</strong> – <strong>optional</strong> water density, kg/m^3, default 1000</p></li>
<li><p><strong>a</strong> – <strong>optional</strong> coefficient of thermal expansion, m^2/sec, default 3e-5</p></li>
<li><p><strong>k</strong> – <strong>optional</strong> thermal diffusivity, m^2/sec, default 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>gridded temperature over (x,z), seafloor subsidence in meters</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.grav.up_vecs">
<span class="sig-prename descclassname"><span class="pre">shipgrav.grav.</span></span><span class="sig-name descname"><span class="pre">up_vecs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cacc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lacc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_off</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ldamp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.grav.up_vecs" title="Link to this definition">¶</a></dt>
<dd><p>Calculate 3xN matrix of platform up-pointing vectors in (cross, long) coordinates</p>
<p>the on_off flag is still kind of mysterious to me but if it is
0 then things are actually calculated; if &gt;0 then the
accelerations get zeroed out</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.grav.wgs_grav">
<span class="sig-prename descclassname"><span class="pre">shipgrav.grav.</span></span><span class="sig-name descname"><span class="pre">wgs_grav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.grav.wgs_grav" title="Link to this definition">¶</a></dt>
<dd><p>Theoretical gravity for WGS84 ellipsoid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lat</strong> – latitude, degrees</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-shipgrav.nav">
<span id="nav-module"></span><h2><code class="xref py py-mod docutils literal notranslate"><span class="pre">nav</span></code> Module<a class="headerlink" href="#module-shipgrav.nav" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.nav.ll2en">
<span class="sig-prename descclassname"><span class="pre">shipgrav.nav.</span></span><span class="sig-name descname"><span class="pre">ll2en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.nav.ll2en" title="Link to this definition">¶</a></dt>
<dd><p>Convert time series of geographic position to E/N velocities.</p>
<p>Lon/lat pairs should be at a constant sampling rate. The first and last five 
values of the output arrays are filled with Nan because the differencing scheme
has some edge effects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – np.ndarray of longitude points, decimal degrees</p></li>
<li><p><strong>lat</strong> – np.ndarray of latitude points, decimal degrees</p></li>
<li><p><strong>freq</strong> – frequency of the position data, Hz (default: 1 Hz)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.nav.rot_acc_EN_cl">
<span class="sig-prename descclassname"><span class="pre">shipgrav.nav.</span></span><span class="sig-name descname"><span class="pre">rot_acc_EN_cl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">heading</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accN</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.nav.rot_acc_EN_cl" title="Link to this definition">¶</a></dt>
<dd><p>Rotate acceleration from East/North to Cross/Long reference frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>heading</strong> – heading, in degrees clockwise from N</p></li>
<li><p><strong>accE</strong> – east acceleration</p></li>
<li><p><strong>accN</strong> – north acceleration</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.nav.vevn2cv">
<span class="sig-prename descclassname"><span class="pre">shipgrav.nav.</span></span><span class="sig-name descname"><span class="pre">vevn2cv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ve</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.nav.vevn2cv" title="Link to this definition">¶</a></dt>
<dd><p>Calculate velocity and heading from east and north velocities.</p>
<p>Output heading is in degrees clockwise from N.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ve</strong> – east velocity</p></li>
<li><p><strong>vn</strong> – north velocity</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-shipgrav.utils">
<span id="utils-module"></span><h2><code class="xref py py-mod docutils literal notranslate"><span class="pre">utils</span></code> Module<a class="headerlink" href="#module-shipgrav.utils" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="shipgrav.utils.SnappingCursor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shipgrav.utils.</span></span><span class="sig-name descname"><span class="pre">SnappingCursor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.utils.SnappingCursor" title="Link to this definition">¶</a></dt>
<dd><p>A cross-hair cursor that snaps to the closest <em>x</em> point on a line</p>
<p>This is for a two-axis figure where the first axis (ax1) 
has a cross-hair cursor, and the second axis (ax2) has a dot that’s linked
to the cursor in ax1. Basically, we can plot two different values for one
time series, and use a cursor over one of them to move a dot around on the other one.</p>
<p>The time series with the cross hair cursor must have x values that are unique and sorted.</p>
<p>Since this class is designed for a specific use case, there are some hard-coded assumptions
about the names of columns in the DataFrame being used for plotting.</p>
<p>The cursor can also register mouse clicks so the user can interactively select points
that are accessible later.</p>
<p>For usage, see the example script interactive_line_pick.py included with the
shipgrav package</p>
<p>Heavily adapted from the matplotlib cross-hair cursor demo at
<a class="reference external" href="https://matplotlib.org/stable/gallery/event_handling/cursor_demo.html">https://matplotlib.org/stable/gallery/event_handling/cursor_demo.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax1</strong> – first axis, for cursor; x axis unique and sorted (tsec in data)</p></li>
<li><p><strong>ax2</strong> – second axis, for points; lon_new vs lat_new in data</p></li>
<li><p><strong>line</strong> – the line plotted in ax1, of type matplotlib.lines.Line2D</p></li>
<li><p><strong>dot</strong> – single point plotted in ax2 that will move around, also Line2D</p></li>
<li><p><strong>data</strong> – pd.DataFrame with tsec, lon_new, and lat_new columns that correspond
to what’s plotted in both axes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.utils.clean_ini_to_toml">
<span class="sig-prename descclassname"><span class="pre">shipgrav.utils.</span></span><span class="sig-name descname"><span class="pre">clean_ini_to_toml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ini_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.utils.clean_ini_to_toml" title="Link to this definition">¶</a></dt>
<dd><p>Read in a .ini file and try to write a toml-compliant file.</p>
<p>This uses simple, prescriptive regex stuff to (hopefully) clean out
ini conventions that don’t work with toml.
It writes out a toml file named by default as ini_file:r.toml</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.utils.gaussian_filter">
<span class="sig-prename descclassname"><span class="pre">shipgrav.utils.</span></span><span class="sig-name descname"><span class="pre">gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.utils.gaussian_filter" title="Link to this definition">¶</a></dt>
<dd><p>Apply a gaussian filter to a vector.</p>
<p>The filtering is done via a ring buffer; results are not identical to 
scipy.ndimage.gaussian_filter, which is why this function exists.
Note that the filter is not applied symmetrically and there is a shift by fl.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – time series data to be filtered.</p></li>
<li><p><strong>fl</strong> – length of the filter in # of samples.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shipgrav.utils.status_bits">
<span class="sig-prename descclassname"><span class="pre">shipgrav.utils.</span></span><span class="sig-name descname"><span class="pre">status_bits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'status'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shipgrav.utils.status_bits" title="Link to this definition">¶</a></dt>
<dd><p>Decode status bits from integers in DGS gravimeter files.</p>
<p>Return flags as a dict (for one integer input) or a dataframe (status df input)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stat</strong> – status bit, either an integer or a DataFrame with status
as one of the columns (labeled by key)</p></li>
<li><p><strong>key</strong> – the DataFrame column for the status bits if input is a DataFrame</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="indices">
<h1>Indices<a class="headerlink" href="#indices" title="Link to this heading">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">shipgrav</a></h1>








<h3>Navigation</h3>
<ul>
<li><a class="reference internal" href="#">Shipgrav</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#modules-and-files">Modules and files</a></li>
<li><a class="reference internal" href="#data-directories">Data directories</a></li>
<li><a class="reference internal" href="#navigation-data">Navigation data</a></li>
<li><a class="reference internal" href="#example-scripts">Example scripts</a></li>
<li><a class="reference internal" href="#help">Help!</a></li>
<li><a class="reference internal" href="#testing">Testing</a></li>
<li><a class="reference internal" href="#contributing">Contributing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#api-reference">API Reference</a><ul>
<li><a class="reference internal" href="#module-shipgrav.io"><code class="xref py py-mod docutils literal notranslate"><span class="pre">io</span></code> Module</a><ul>
<li><a class="reference internal" href="#shipgrav.io.read_bgm_raw"><code class="docutils literal notranslate"><span class="pre">read_bgm_raw()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.io.read_bgm_rgs"><code class="docutils literal notranslate"><span class="pre">read_bgm_rgs()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.io.read_dat_dgs"><code class="docutils literal notranslate"><span class="pre">read_dat_dgs()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.io.read_nav"><code class="docutils literal notranslate"><span class="pre">read_nav()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.io.read_other_stuff"><code class="docutils literal notranslate"><span class="pre">read_other_stuff()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.io.read_raw_dgs"><code class="docutils literal notranslate"><span class="pre">read_raw_dgs()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-shipgrav.grav"><code class="xref py py-mod docutils literal notranslate"><span class="pre">grav</span></code> Module</a><ul>
<li><a class="reference internal" href="#shipgrav.grav.calc_ccp"><code class="docutils literal notranslate"><span class="pre">calc_ccp()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.grav.center_diff"><code class="docutils literal notranslate"><span class="pre">center_diff()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.grav.crustal_thickness_2D"><code class="docutils literal notranslate"><span class="pre">crustal_thickness_2D()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.grav.eotvos_full"><code class="docutils literal notranslate"><span class="pre">eotvos_full()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.grav.fa_2ord"><code class="docutils literal notranslate"><span class="pre">fa_2ord()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.grav.grav2d_long"><code class="docutils literal notranslate"><span class="pre">grav2d_long()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.grav.longman_tide_pred"><code class="docutils literal notranslate"><span class="pre">longman_tide_pred()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.grav.therm_Z"><code class="docutils literal notranslate"><span class="pre">therm_Z()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.grav.therm_Z_plate_approx"><code class="docutils literal notranslate"><span class="pre">therm_Z_plate_approx()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.grav.therm_halfspace"><code class="docutils literal notranslate"><span class="pre">therm_halfspace()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.grav.therm_plate"><code class="docutils literal notranslate"><span class="pre">therm_plate()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.grav.up_vecs"><code class="docutils literal notranslate"><span class="pre">up_vecs()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.grav.wgs_grav"><code class="docutils literal notranslate"><span class="pre">wgs_grav()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-shipgrav.nav"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nav</span></code> Module</a><ul>
<li><a class="reference internal" href="#shipgrav.nav.ll2en"><code class="docutils literal notranslate"><span class="pre">ll2en()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.nav.rot_acc_EN_cl"><code class="docutils literal notranslate"><span class="pre">rot_acc_EN_cl()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.nav.vevn2cv"><code class="docutils literal notranslate"><span class="pre">vevn2cv()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-shipgrav.utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">utils</span></code> Module</a><ul>
<li><a class="reference internal" href="#shipgrav.utils.SnappingCursor"><code class="docutils literal notranslate"><span class="pre">SnappingCursor</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.utils.clean_ini_to_toml"><code class="docutils literal notranslate"><span class="pre">clean_ini_to_toml()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.utils.gaussian_filter"><code class="docutils literal notranslate"><span class="pre">gaussian_filter()</span></code></a></li>
<li><a class="reference internal" href="#shipgrav.utils.status_bits"><code class="docutils literal notranslate"><span class="pre">status_bits()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#indices">Indices</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Hannah Mark.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>